"use strict";(function(e){function t(t){switch(t.status){case 504:e.spawnAlert({title:"Error 504",body:"Server timeout on a remote request.",color:"danger"});break;case 500:e.spawnAlert({title:"Error 500",body:"Server error when processing your request.",color:"danger"});break;case 405:e.spawnAlert({title:"Error 405",body:"Method not allowed for the requested resource.",color:"danger"});break;case 404:e.spawnAlert({title:"Error 404",body:"The requested resource could not be found.",color:"danger"});break;case 403:e.spawnAlert({title:"Error 403",body:"Access denied to the requested resource.",color:"danger"});break;case 401:e.spawnAlert({title:"Error 401",body:"No permissions for the requested resource.",color:"danger"});break;case 0:switch(t.statusText){case"timeout":e.spawnAlert({title:"Timeout",body:"Waiting time has been exceeded.",color:"danger"});break;case"error":e.spawnAlert({title:"No connection",body:"No Internet connection has been detected to process your request.",color:"danger"});break;default:e.spawnAlert({title:"Error",body:"Error "+t.statusText,color:"danger"})}break;default:e.spawnAlert({title:"Unknwon error",body:"Unknown network error, check JS console.",color:"danger"})}}e.extend({qs:function(e){e=e.replace(/[*+?^$.\[\]{}()|\\\/]/g,"\\$&");var t=location.search.match(new RegExp("[?&]"+e+"=([^&]+)(&|$)"));return t&&decodeURIComponent(t[1].replace(/\+/g," "))}}),e.extend({sec2dhms:function(e){return parseInt(e/86400)+"d "+new Date(e%86400*1e3).toUTCString().replace(/.*(\d{2}):(\d{2}):(\d{2}).*/,"$1:$2:$3")},bytes2humanReadable:function(e,t,n,o,r){return(t=Math,n=t.log,o=1024,r=n(e)/n(o)|0,e/t.pow(o,r)).toFixed(2)+" "+(r?"KMGTPEZY"[--r]+"B":"Bytes")},bits2humanReadable:function(e,t,n,o,r){return(t=Math,n=t.log,o=1e3,r=n(e)/n(o)|0,e/t.pow(o,r)).toFixed(2)+" "+(r?"kMGTPEZY"[--r]+"b":"bits")},round:function(e,t){var n=Math.pow(10,t||0);return Math.round(e*n)/n},uts2dt:function(e){var t=new Date(1e3*e);return t.getFullYear()+"/"+(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"/"+(t.getDate()<10?"0"+t.getDate():t.getDate())+" "+(t.getHours()<10?"0"+t.getHours():t.getHours())+":"+(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes())+":"+(t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds())},uts2dtm:function(t){var n=new Date(1e3*t);return e.uts2dt(t)+"."+n.getMilliseconds().toString().padEnd(3,"0")},uts2td:function(e){var t=new Date(1e3*e);return(t.getHours()<10?"0"+t.getHours():t.getHours())+":"+(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes())+":"+(t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds())+" "+(t.getDate()<10?"0"+t.getDate():t.getDate())+"/"+(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"/"+t.getFullYear()},uts2tmd:function(e){var t=new Date(1e3*e);return(t.getHours()<10?"0"+t.getHours():t.getHours())+":"+(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes())+":"+(t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds())+"."+t.getMilliseconds().toString().padEnd(3,"0")+" "+(t.getDate()<10?"0"+t.getDate():t.getDate())+"/"+(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"/"+t.getFullYear()},ip2num:function(e){var t=e.split(".");return 256*(256*(256*+t[0]+ +t[1])+ +t[2])+ +t[3]},num2ip:function(e){for(var t=e%256,n=3;n>0;n--)e=Math.floor(e/256),t=e%256+"."+t;return t},isValidDate:function(e,t,n){var o=new Date(n,t-1,e);return o.getFullYear()==n&&o.getMonth()+1==t&&o.getDate()==e},htmlEntities:function(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/ /g,"&nbsp;")},hexEncode:function(e){var t,n,o="";for(n=0;n<e.length;n++)t=e.charCodeAt(n).toString(16),o+=("000"+t).slice(-4);return o},hexDecode:function(e){var t,n=e.match(/.{1,4}/g)||[],o="";for(t=0;t<n.length;t++)o+=String.fromCharCode(parseInt(n[t],16));return o},calculateAspectRatio:function(e,t,n,o){var r=Math.min(n/e,o/t);return{width:e*r,height:t*r}}}),e.extend({setData:function(e,t){if("undefined"!=typeof Storage)try{return localStorage.setItem(e,t),!0}catch(e){alert("Error: "+e.message)}return!1},getData:function(e){return"undefined"!=typeof Storage&&localStorage.getItem(e)},removeData:function(e){return"undefined"!=typeof Storage&&(localStorage.removeItem(e),!0)},clearData:function(e){return"undefined"!=typeof Storage&&(localStorage.clear(),!0)},isNullData:function(e){return"undefined"==typeof Storage||null===localStorage.getItem(e)},getDataSize:function(){for(var t,n=0,o=0;o<localStorage.length;o++)t=localStorage.getItem(localStorage.key(o)).length,n+=t,console.log(localStorage.key(o)+" = "+e.bytes2humanReadable(t));return console.log("--\nTotal: "+e.bytes2humanReadable(n)),n},setSessionData:function(e,t){if("undefined"!=typeof Storage)try{return sessionStorage.setItem(e,t),!0}catch(e){alert("Error: "+e.message)}return!1},getSessionData:function(e){return"undefined"!=typeof Storage&&sessionStorage.getItem(e)},removeSessionData:function(e){return"undefined"!=typeof Storage&&(sessionStorage.removeItem(e),!0)},clearSessionData:function(e){return"undefined"!=typeof Storage&&(sessionStorage.clear(),!0)},isSessionNullData:function(e){return"undefined"==typeof Storage||null===sessionStorage.getItem(e)},getSessionDataSize:function(){for(var t,n=0,o=0;o<sessionStorage.length;o++)t=sessionStorage.getItem(sessionStorage.key(o)).length,n+=t,console.log(sessionStorage.key(o)+" = "+e.bytes2humanReadable(t));return console.log("--\nTotal: "+e.bytes2humanReadable(n)),n}}),e.extend({canShare:function(){return void 0!==navigator.share},share:function(t){var n=e.extend({title:"",text:"",url:window.location.href,complete:function(){},error:function(e){}},t);navigator.share({title:n.title,text:n.text,url:n.url}).then(n.complete()).catch(n.error(error))}}),e.extend({randomInt:function(){return parseInt(Date.now()*Math.random())},randomString:function(){return Math.random().toString(36).substr(2)},randomUUID:function(){var e=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)};return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()},randomHex:function(e){null==e&&(e=1);for(var t=[],n="0123456789ABCDEF",o=0;o<e;o++)t.push(n.charAt(Math.floor(Math.random()*n.length)));return t.join("")}}),e.extend({filterObject:function(t,n,o){function r(e,t){var n=new RegExp(o,"gi");const r=t;let a;for(;null!==(a=n.exec(r));)if(a.index===n.lastIndex&&n.lastIndex++,null!=a)return!0}var a=new Array;return e.grep(e.objectToArray(t),function(e){r(o,e[n])&&a.push(e)}),a},attrToObject:function(t,n,o){function r(t,n){var o=new Object,r=n+"-int-",a=n+"-str-";return t.each(function(){e.each(this.attributes,function(){-1!=this.name.indexOf(r)?o[this.name.replace(r,"")]=parseInt(this.value):-1!=this.name.indexOf(a)?o[this.name.replace(a,"")]=this.value:-1!=this.name.indexOf(n)&&(o[this.name.replace(n+"-","")]=this.value)})}),o}return o=null==o?"data":o,null==t.tagName&&"object"==typeof t?r(t,o):t.tagName.toLowerCase()==n.toLowerCase()?r(e(t),o):r(e(t).parent(),o)},objectSize:function(e){var t,n=0;for(t in e)e.hasOwnProperty(t)&&n++;return n},objectToArray:function(e){var t=jQuery.extend(!0,{},e),n=new Array;for(var o in t)n.push(t[o]);return n},arrayToObject:function(e){return e.reduce(function(e,t){return e[t]=t,e},{})},objectFindItem:function(t,n,o){var r=e.grep(e.objectToArray(t),function(e){return e[n]==o});return null!=r?r[0]:r},objectSortBy:function(t,n){function o(e){var t=n;return function(e,n){for(var o=0,a=0,i=t.length;0===a&&o<i;)a=r(t[o])(e,n),o++;return a}}function r(e){var t=1;return"-"===e[0]&&(t=-1,e=e.substr(1,e.length-1)),function(n,o){var r=n[e]<o[e]?-1:n[e]>o[e]?1:0;return r*t}}var a=e.objectToArray(t);return a.sort(o.apply(null,n))}}),e.extend({spawnPrinter:function(t){var n=e.extend({windowWidth:800,windowHeight:600,headSelector:"head",bodySelector:"body",end:function(){}},t),o=window.open("about:blank","Print","width="+n.windowWidth+",height="+n.windowHeight);o.document.open(),o.document.write('<!doctype html><html lang="en"><head>'+e(n.headSelector).html()+"</head><body>"+e(n.bodySelector).html()+"</body></html>"),o.document.close(),o.focus(),setTimeout(function(){return o.print(),o.close(),n.end.call(),!0},500)}}),e.extend({api:function(n){var o=e.extend({method:"POST",url:null!=e.qs("s")?"api.php?s="+e.qs("s"):"api.php",data:{},dataType:"json",timeout:1e4,contentType:"application/json; charset=UTF-8",beforeSend:function(){},success:function(e){},failure:function(t){e.spawnAlert({body:t.msg,color:t.color})},error:function(e){},complete:function(){},spawnSpinner:!0,debug:!1},n);e.ajax({method:o.method,url:o.url,data:JSON.stringify(o.data),dataType:o.dataType,timeout:o.timeout,contentType:o.contentType,beforeSend:function(t,n){o.debug&&console.log(n),o.spawnSpinner&&e.spawnSpinner(),o.beforeSend()},success:function(e,t,n){o.debug&&console.log(e),"ok"===e.status?o.success(e):o.failure(e)},error:function(e,n,r){o.debug&&console.log(e),t(e),o.error(e)},complete:function(t,n){o.debug&&console.log(n),o.spawnSpinner&&e.removeSpinner(),o.complete()}})},upload:function(n){var o=Date.now(),r=e.extend({method:"POST",url:null!=e.qs("s")?"api.php?s="+e.qs("s"):"api.php",data:new FormData(e("form").get(0)),dataType:"json",timeout:0,progress:function(e){console.log(e)},beforeSend:function(){},success:function(e){},failure:function(t){e.spawnAlert({body:t.msg,color:t.color})},error:function(e){},complete:function(){},spawnSpinner:!0,debug:!1},n);e.ajax({method:r.method,url:r.url,data:r.data,dataType:r.dataType,timeout:r.timeout,cache:!1,contentType:!1,processData:!1,enctype:"multipart/form-data",xhr:function(){var t=e.ajaxSettings.xhr();return t.upload&&t.upload.addEventListener("progress",function(t){if(t.lengthComputable){var n={length_computable:t.lengthComputable,bytes_loaded:t.loaded,bytes_total:t.total,bytes_remaining:t.total-t.loaded,bytes_per_second:0,seconds_elapsed:e.round((Date.now()-o)/1e3,1),seconds_remaining:""};n.bytes_per_second=n.seconds_elapsed?e.round(t.loaded/n.seconds_elapsed):0,n.seconds_remaining=n.seconds_elapsed?e.round(n.bytes_remaining/n.bytes_per_second,1):"",r.progress(n)}else r.progress({length_computable:t.lengthComputable})},!1),t},beforeSend:function(t,n){r.debug&&console.log(n),r.spawnSpinner&&e.spawnSpinner(),r.beforeSend()},success:function(e,t,n){r.debug&&console.log(e),"ok"===e.status?r.success(e):r.failure(e)},error:function(e,n,o){r.debug&&console.log(e),t(e),r.error(e)},complete:function(t,n){r.debug&&console.log(n),r.spawnSpinner&&e.removeSpinner(),r.complete()}})},head:function(t){var n=e.extend({method:"HEAD",url:"",timeout:3e3,data:{},beforeSend:function(){},success:function(e){},error:function(e){},complete:function(){},debug:!1},t);e.ajax({method:n.method,url:n.url,timeout:n.timeout,beforeSend:function(e,t){n.debug&&console.log(t),n.beforeSend()},success:function(){n.debug&&console.log("Success!"),n.success(n.data)},error:function(){n.debug&&console.log("Error!"),n.error(n.data)},complete:function(){n.debug&&console.log("Complete!"),n.complete()}})},websocket:function(t){var n,o=e.extend({url:"",onopen:function(){},onclose:function(){},onmessage:function(e){},onerror:function(){},spawnSpinner:!0,reconnectingTxt:"Reconnecting...",reconnectingTxtColor:"warning",debug:!1},t);if("ReconnectingWebSocket"in window)n=new ReconnectingWebSocket(o.url,null,{debug:o.debug});else{if(!("WebSocket"in window))return void console.error("No WebSocket modules found, exiting.");n=new WebSocket(o.url),console.warn("ReconnectingWebSocket library not found, using standard WebSocket.")}return n.onopen=function(){o.debug&&console.log("WebSocket open: "+n.url),o.spawnSpinner&&e.removeSpinner(),o.onopen()},n.onclose=function(){o.debug&&console.log("WebSocket close"),o.spawnSpinner&&e.spawnSpinner({text:o.reconnectingTxt,textcolor:o.reconnectingTxtColor}),o.onclose()},n.onmessage=function(t){o.debug&&console.log("WebSocket message");try{o.onmessage(JSON.parse(t.data))}catch(n){e.spawnAlert({title:"Invalid Websocket messagee",body:t.data,color:"danger"})}},n.onerror=function(){o.debug&&console.log("WebSocket error"),o.onerror()},n}}),e.extend({spawnSpinner:function(t){if(!e("#spinner").length){var n=e.extend({text:"Loading...",textcolor:"dark",bgcolor:"rgba(0,0,0,.33)",innerbgcolor:"rgba(255,255,255,.9);",innerborder:"1px solid rgba(128,128,128,.9);",icon:"grow",size:2},t);e("body").append('<div id="spinner" class="fixed-top d-flex flex-column align-items-center justify-content-center" style="background-color:'+n.bgcolor+';bottom:0;z-index:1111;"><div class="p-3 text-'+n.textcolor+' text-center rounded-lg" style="background-color:'+n.innerbgcolor+";border:"+n.innerborder+';max-width:75%;"><div class="spinner-'+n.icon+'" style="width:'+n.size+"rem;height:"+n.size+'rem;" role="status"><span class="sr-only">'+n.text+'</span></div><div class="spinnerTxt">'+n.text+"</div></div></div>")}},removeSpinner:function(t){e("#spinner").remove()}}),e.extend({spawnModal:function(t){if(!e("#modal").length){var n=e.extend({title:"",body:"",showclose:!0,preventclose:!0,fadespawn:!0,verticalcenter:!1,size:"md",buttons:[{label:"Cerrar",dismiss:!0}]},t);e("body").append('<div id="modal" class="modal'+(n.fadespawn?" fade":"")+'" tabindex="-1" role="dialog"><div class="modal-dialog'+(n.verticalcenter?" modal-dialog-centered":"")+" modal-"+n.size+'" role="document"><div class="modal-content"><div class="modal-header"><h5 class="modal-title">'+n.title+"</h5>"+(n.showclose?'<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>':"")+'</div><div class="modal-body">'+n.body+"</div>"+(n.buttons.length?'<div class="modal-footer"></div>':"")+"</div></div></div>"),e("#modal").on("hidden.bs.modal",function(){e("#modal").remove()}),e.each(n.buttons,function(t,n){var o=e.extend({label:"",color:"primary",outline:!1,dismiss:!1,size:"md",click:function(){}},n);e("#modal div.modal-footer").append('<button type="button" class="btn btn-'+(o.outline?"outline-":"")+o.color+" btn-"+o.size+'"'+(o.dismiss?' data-dismiss="modal"':"")+' data-btnidx="'+t+'">'+o.label+"</button>"),e("#modal div.modal-footer button[data-btnidx='"+t+"']").on("click",o.click)}),e("#modal").modal({backdrop:!n.preventclose||"static",keyboard:!n.preventclose}),e("#modal").modal("show")}},spawnRemoteModal:function(n){if(!e("#modal").length){var o=e.extend({method:"GET",url:"",data:{},timeout:1e4,success:function(){},error:function(){},complete:function(){},preventclose:!0,fadespawn:!0,verticalcenter:!1,size:"md",buttons:[],spawnSpinner:!0,debug:!1},n);e.ajax({method:o.method,url:o.url,data:o.data,timeout:o.timeout,beforeSend:function(t,n){o.debug&&console.log(n),o.spawnSpinner&&e.spawnSpinner()},success:function(t){e.spawnModal(o),e("#modal div.modal-content").html(t),o.success()},error:function(e,n,r){o.debug&&console.log(e),t(e),o.error()},complete:function(t,n){o.debug&&console.log(n),o.spawnSpinner&&e.removeSpinner(),o.complete()}})}},removeModal:function(t){var n=e.extend({hidden:function(){},delayhidden:100},t);e("#modal").on("hidden.bs.modal",function(){setTimeout(n.hidden,n.delayhidden)}),e("#modal").modal("hide")}}),e.extend({spawnAlert:function(t){var n=e.extend({title:"",subtitle:"",body:"",color:"info",showclose:!0,delay:5e3,animateCssEffect:"fadeInRight",toastId:e.randomInt()},t);e("#toaster").length||e("body").append('<div id="toaster" aria-live="polite" aria-atomic="true" class="fixed-top p-2" style="left:unset;z-index:1111;"></div>'),e("#toaster").append('<div id="toast-'+n.toastId+'" class="toast shadow-lg" role="alert" aria-live="assertive" aria-atomic="true" data-delay="'+n.delay+'"><div class="toast-header"><div class="rounded mr-2" style="width:20px;height:20px;background-color:var(--'+n.color+');"></div><strong class="mr-auto">'+n.title+"</strong><small>"+n.subtitle+"</small>"+(n.showclose?'<button type="button" class="ml-2 mb-1 close" data-dismiss="toast" aria-label="Close"><span aria-hidden="true">&times;</span></button>':"")+"</div>"+(""!=n.body?'<div class="toast-body">'+n.body+"</div>":"")+"</div>"),void 0!==e.fn.animateCss&&e("#toast-"+n.toastId).on("show.bs.toast",function(){e("#toast-"+n.toastId).animateCss({effect:n.animateCssEffect})}),e("#toast-"+n.toastId).on("hidden.bs.toast",function(){e("#toast-"+n.toastId).remove()}),e("#toast-"+n.toastId).toast("show")},removeAlert:function(t){var n=e.extend({toastId:0},t);e("#toast-"+n.toastId).toast("hide")}}),e.fn.serializeForm=function(){var e=this.serializeArray().concat(this.find("input[type='checkbox']:not(:checked)").map(function(){return{name:this.name,value:"off"}}).get()),t=new Object;for(var n in e)t[e[n].name]=e[n].value;return t},e.fn.runNumber=function(t){var n=e.extend({duration:1e3,decimalPos:0,fromVal:0,toVal:100,delayStart:0,prefix:"",suffix:""},t),o=this;e(o).text(n.prefix+n.fromVal.toFixed(n.decimalPos)+n.suffix),e({someValue:n.fromVal}).delay(n.delayStart).animate({someValue:n.toVal},{duration:n.duration,step:function(){e(o).text(n.prefix+this.someValue.toFixed(n.decimalPos)+n.suffix)},complete:function(){e(o).text(n.prefix+this.someValue.toFixed(n.decimalPos)+n.suffix)}})},e.fn.imageThumbnailer=function(t){var n=e.extend({width:800,height:600,imgFile:null},t),o=this,r=new Image;try{r.src=URL.createObjectURL(n.imgFile)}catch(e){alert(e)}r.onload=function(){var t={width:r.width,height:r.height};(r.width>n.width||r.height>n.height)&&(t=e.calculateAspectRatio(r.width,r.height,n.width,n.height));var a=document.createElement("canvas");switch(a.width=t.width,a.height=t.height,a.getContext("2d").drawImage(r,0,0,t.width,t.height),n.imgFile.type){case"image/jpeg":o.trigger("thumbnailGenerated",[{success:!0,file:n.imgFile,type:"image/jpeg",image:a.toDataURL("image/jpeg")}]);break;case"image/png":case"image/svg+xml":o.trigger("thumbnailGenerated",[{success:!0,file:n.imgFile,type:"image/png",image:a.toDataURL("image/png")}]);break;default:console.warn("Can't process: "+n.imgFile.type),o.trigger("thumbnailGenerated",[{success:!1,file:n.imgFile}])}},r.onerror=function(){console.error("Not an image: "+n.imgFile.name),o.trigger("thumbnailGenerated",[{success:!1,file:n.imgFile}])}},e.fn.renameAttr=function(t,n){return this.each(function(){e(this).attr(n,e(this).attr(t)).removeAttr(t)})},e.fn.SVGinliner=function(t){var n=e.extend({fillColor:""},t);this.each(function(){var t=e(this);e.get(e(this).attr("src"),function(o){var r=e(o).find("svg");null!=t.attr("id")&&r.attr("id",t.attr("id")),null!=t.attr("class")&&r.attr("class",t.attr("class")),null!=t.attr("style")&&r.attr("style",t.attr("style")),r.css("fill",n.fillColor),t.replaceWith(r.removeAttr("xmlns:a"))},"xml").fail(function(){console.log("Error retrieving the SVG file.")})})},e.fn.attrToObject=function(t){var n=e.extend({prefix:"data-"},t),o=new Object;return e.each(this.get(0).attributes,function(e,t){if(t.name.startsWith(n.prefix))switch(t.name.substring(t.name.indexOf("-")+1,t.name.lastIndexOf("-"))){case"str":o[t.name.substring(t.name.lastIndexOf("-")+1)]=t.value;break;case"int":o[t.name.substring(t.name.lastIndexOf("-")+1)]=parseInt(t.value);break;case"flt":o[t.name.substring(t.name.lastIndexOf("-")+1)]=parseFloat(t.value);break;case"bol":o[t.name.substring(t.name.lastIndexOf("-")+1)]="true"==t.value;break;default:console.warn("Data type '"+t.name+"' not processed.")}}),this.length>1&&console.warn("Selector includes multiple items. Only first was processed."),o}})(jQuery);